<!DOCTYPE html>
<html>
    <head>
        <title>Countdown Thingy</title>
        <link rel="stylesheet" href="https://ehui.ehan.dev/css/colors.css" />
        <link rel="stylesheet" href="https://ehui.ehan.dev/css/components.css" />
        <link rel="stylesheet" href="https://ehui.ehan.dev/css/layouts.css" />
        <link rel="stylesheet" href="https://ehui.ehan.dev/css/utils.css" />
    </head>
    <body>
        <main class="grid screen">
            <div class="content"> 
                <div class="flex">
                    <input id="inputTime" type="text" placeholder="00:00" />
                    <button id="buttonStart">Start</button>
                </div>
                <p id="time" class="h1">00:00:00</p>
            </div>
        </main>
        <script>
            var params = new URLSearchParams(window.location.search);
            var until = new Date();
            if (params.get("time")) {
                until.setHours(params.get("time").split(":")[0]);
                until.setMinutes(params.get("time").split(":")[1]);

            } else {
                until.setHours("14");
                until.setMinutes("06");
            }
            until.setSeconds("0");
            until.setMilliseconds("0");
            document.getElementById("buttonStart").addEventListener(
                "click",
                function () {
                    until.setHours(
                        document.getElementById("inputTime").value.split(":")[0]
                    )
                    until.setMinutes(
                        document.getElementById("inputTime").value.split(":")[1]
                    )
                }
            );
            function updateTime() {
                var now = new Date();
                var diff = (
                    (
                        until.getTime() - now.getTime()
                    ) / 1000
                );
                var diffHours = Math.trunc(
                    (diff / (60 * 60))
                );
                var diffMin = Math.trunc(
                    ((diff / 60) - (diffHours * 60))
                );
                var diffSec = Math.trunc(
                    ((diff - (diffHours * (60 * 60))) - (diffMin * 60))
                );
                document.getElementById("time").innerText = diffHours.toString().padStart(2, "0") +
                ":" + diffMin.toString().padStart(2, "0") +
                ":" + diffSec.toString().padStart(2, "0");
            }
            setInterval(updateTime, 500);
        </script>
    </body>
</html>
